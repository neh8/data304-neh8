<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Noelle Haviland">

<title>Homework 3 Revision</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="hw3_revision_files/libs/clipboard/clipboard.min.js"></script>
<script src="hw3_revision_files/libs/quarto-html/quarto.js"></script>
<script src="hw3_revision_files/libs/quarto-html/popper.min.js"></script>
<script src="hw3_revision_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="hw3_revision_files/libs/quarto-html/anchor.min.js"></script>
<link href="hw3_revision_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="hw3_revision_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="hw3_revision_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="hw3_revision_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="hw3_revision_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Homework 3 Revision</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Noelle Haviland </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="load-packages-and-data" class="level2">
<h2 class="anchored" data-anchor-id="load-packages-and-data">Load Packages and Data</h2>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> altair <span class="im">as</span> alt</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>twins_long <span class="op">=</span> pd.read_csv(<span class="st">'https://calvin-data304.netlify.app/data/twins-genetics-long.csv'</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>twins_wide <span class="op">=</span> pd.read_csv(<span class="st">'https://calvin-data304.netlify.app/data/twins-genetics-wide.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>a. I liked Lien’s Comparing Kits graph because it includes a slider that lets us see the different pairs of twins without having to scroll through a very long or very wide graph. It easily shows how different DNA kits have different genetic shares for regions for the same pair of twins. One thing I would change is that the colors by region are not consistent for different pairs, but I believe this is just a problem of the slider changing the colors across different sub-graphs. Is there a way to make sure the colors are consistent even when the slider is moved? It seems like there should be a way to set consistent colors across</p>
<p>c. I don’t like when scatter plots are used to visualize this data because I know now what the genetic share means. The scatter plots for comparing kits imply that there is a linear trend between the shares of two kits, which is both wrong and a misrepresentation of the data. I am talking specifically about Aaron’s Comparing Twins graph and Ryan’s Comparing Kits graph. Dot plots like John and Daniel used are more honest, but do not necessarily represent the data story better.</p>
<p>d.Two Graphs:</p>
<p>Comparing Kits:</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>compare_twins <span class="op">=</span> alt.Chart(twins_long).mark_rect().encode(</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  x<span class="op">=</span><span class="st">"id:N"</span>,</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  y<span class="op">=</span><span class="st">"genetic share:Q"</span>,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  color<span class="op">=</span><span class="st">"region:N"</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>).facet(column<span class="op">=</span><span class="st">"kit:N"</span>, row<span class="op">=</span><span class="st">"pair:N"</span>).properties(title<span class="op">=</span><span class="st">"Proportion of Difference in Shared DNA from Different Regions among Twins"</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>compare_twins</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">

<style>
  #altair-viz-a801eb4afc6a4837afde39eda9207b49.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-a801eb4afc6a4837afde39eda9207b49.vega-embed details,
  #altair-viz-a801eb4afc6a4837afde39eda9207b49.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-a801eb4afc6a4837afde39eda9207b49"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-a801eb4afc6a4837afde39eda9207b49") {
      outputDiv = document.getElementById("altair-viz-a801eb4afc6a4837afde39eda9207b49");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.8.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.8.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "data": {"name": "data-d9664b3f38f6546e2a5b7833f81deddf"}, "facet": {"column": {"field": "kit", "type": "nominal"}, "row": {"field": "pair", "type": "nominal"}}, "spec": {"mark": {"type": "rect"}, "encoding": {"color": {"field": "region", "type": "nominal"}, "x": {"field": "id", "type": "nominal"}, "y": {"field": "genetic share", "type": "quantitative"}}}, "title": "Proportion of Difference in Shared DNA from Different Regions among Twins", "$schema": "https://vega.github.io/schema/vega-lite/v5.8.0.json", "datasets": {"data-d9664b3f38f6546e2a5b7833f81deddf": [{"twin": "1A", "pair": 1, "id": "A", "region": "NW Europe", "kit": "Ancestry", "genetic share": 0.9}, {"twin": "1A", "pair": 1, "id": "A", "region": "NW Europe", "kit": "23andMe", "genetic share": 0.676}, {"twin": "1A", "pair": 1, "id": "A", "region": "NW Europe", "kit": "MyHeritage", "genetic share": 0.647}, {"twin": "1A", "pair": 1, "id": "A", "region": "SE Europe", "kit": "Ancestry", "genetic share": 0.1}, {"twin": "1A", "pair": 1, "id": "A", "region": "SE Europe", "kit": "23andMe", "genetic share": 0.32}, {"twin": "1A", "pair": 1, "id": "A", "region": "SE Europe", "kit": "MyHeritage", "genetic share": 0.333}, {"twin": "1B", "pair": 1, "id": "B", "region": "NW Europe", "kit": "Ancestry", "genetic share": 0.9}, {"twin": "1B", "pair": 1, "id": "B", "region": "NW Europe", "kit": "23andMe", "genetic share": 0.691}, {"twin": "1B", "pair": 1, "id": "B", "region": "NW Europe", "kit": "MyHeritage", "genetic share": 0.687}, {"twin": "1B", "pair": 1, "id": "B", "region": "SE Europe", "kit": "Ancestry", "genetic share": 0.1}, {"twin": "1B", "pair": 1, "id": "B", "region": "SE Europe", "kit": "23andMe", "genetic share": 0.305}, {"twin": "1B", "pair": 1, "id": "B", "region": "SE Europe", "kit": "MyHeritage", "genetic share": 0.239}, {"twin": "2A", "pair": 2, "id": "A", "region": "West Africa", "kit": "Ancestry", "genetic share": 0.65}, {"twin": "2A", "pair": 2, "id": "A", "region": "West Africa", "kit": "23andMe", "genetic share": 0.762}, {"twin": "2A", "pair": 2, "id": "A", "region": "West Africa", "kit": "MyHeritage", "genetic share": 0.696}, {"twin": "2A", "pair": 2, "id": "A", "region": "Central Africa", "kit": "Ancestry", "genetic share": 0.22}, {"twin": "2A", "pair": 2, "id": "A", "region": "Central Africa", "kit": "23andMe", "genetic share": 0.076}, {"twin": "2A", "pair": 2, "id": "A", "region": "Central Africa", "kit": "MyHeritage", "genetic share": 0.12}, {"twin": "2A", "pair": 2, "id": "A", "region": "NW Europe", "kit": "Ancestry", "genetic share": 0.12}, {"twin": "2A", "pair": 2, "id": "A", "region": "NW Europe", "kit": "23andMe", "genetic share": 0.139}, {"twin": "2A", "pair": 2, "id": "A", "region": "NW Europe", "kit": "MyHeritage", "genetic share": 0.104}, {"twin": "2A", "pair": 2, "id": "A", "region": "SE Europe", "kit": "Ancestry", "genetic share": 0.01}, {"twin": "2A", "pair": 2, "id": "A", "region": "SE Europe", "kit": "23andMe", "genetic share": 0.006}, {"twin": "2A", "pair": 2, "id": "A", "region": "SE Europe", "kit": "MyHeritage", "genetic share": 0.0}, {"twin": "2B", "pair": 2, "id": "B", "region": "West Africa", "kit": "Ancestry", "genetic share": 0.64}, {"twin": "2B", "pair": 2, "id": "B", "region": "West Africa", "kit": "23andMe", "genetic share": 0.76}, {"twin": "2B", "pair": 2, "id": "B", "region": "West Africa", "kit": "MyHeritage", "genetic share": 0.688}, {"twin": "2B", "pair": 2, "id": "B", "region": "Central Africa", "kit": "Ancestry", "genetic share": 0.23}, {"twin": "2B", "pair": 2, "id": "B", "region": "Central Africa", "kit": "23andMe", "genetic share": 0.078}, {"twin": "2B", "pair": 2, "id": "B", "region": "Central Africa", "kit": "MyHeritage", "genetic share": 0.112}, {"twin": "2B", "pair": 2, "id": "B", "region": "NW Europe", "kit": "Ancestry", "genetic share": 0.12}, {"twin": "2B", "pair": 2, "id": "B", "region": "NW Europe", "kit": "23andMe", "genetic share": 0.131}, {"twin": "2B", "pair": 2, "id": "B", "region": "NW Europe", "kit": "MyHeritage", "genetic share": 0.106}, {"twin": "2B", "pair": 2, "id": "B", "region": "SE Europe", "kit": "Ancestry", "genetic share": 0.01}, {"twin": "2B", "pair": 2, "id": "B", "region": "SE Europe", "kit": "23andMe", "genetic share": 0.006}, {"twin": "2B", "pair": 2, "id": "B", "region": "SE Europe", "kit": "MyHeritage", "genetic share": 0.0}, {"twin": "3A", "pair": 3, "id": "A", "region": "NW Europe", "kit": "Ancestry", "genetic share": 0.99}, {"twin": "3A", "pair": 3, "id": "A", "region": "NW Europe", "kit": "23andMe", "genetic share": 0.987}, {"twin": "3A", "pair": 3, "id": "A", "region": "NW Europe", "kit": "MyHeritage", "genetic share": 0.992}, {"twin": "3A", "pair": 3, "id": "A", "region": "West Africa", "kit": "Ancestry", "genetic share": 0.01}, {"twin": "3A", "pair": 3, "id": "A", "region": "West Africa", "kit": "23andMe", "genetic share": 0.07}, {"twin": "3A", "pair": 3, "id": "A", "region": "West Africa", "kit": "MyHeritage", "genetic share": 0.0}, {"twin": "3B", "pair": 3, "id": "B", "region": "NW Europe", "kit": "Ancestry", "genetic share": 0.99}, {"twin": "3B", "pair": 3, "id": "B", "region": "NW Europe", "kit": "23andMe", "genetic share": 0.987}, {"twin": "3B", "pair": 3, "id": "B", "region": "NW Europe", "kit": "MyHeritage", "genetic share": 0.981}, {"twin": "3B", "pair": 3, "id": "B", "region": "West Africa", "kit": "Ancestry", "genetic share": 0.01}, {"twin": "3B", "pair": 3, "id": "B", "region": "West Africa", "kit": "23andMe", "genetic share": 0.01}, {"twin": "3B", "pair": 3, "id": "B", "region": "West Africa", "kit": "MyHeritage", "genetic share": 0.0}, {"twin": "4A", "pair": 4, "id": "A", "region": "West Africa", "kit": "Ancestry", "genetic share": 0.6}, {"twin": "4A", "pair": 4, "id": "A", "region": "West Africa", "kit": "23andMe", "genetic share": 0.772}, {"twin": "4A", "pair": 4, "id": "A", "region": "West Africa", "kit": "MyHeritage", "genetic share": 0.692}, {"twin": "4A", "pair": 4, "id": "A", "region": "Central Africa", "kit": "Ancestry", "genetic share": 0.27}, {"twin": "4A", "pair": 4, "id": "A", "region": "Central Africa", "kit": "23andMe", "genetic share": 0.076}, {"twin": "4A", "pair": 4, "id": "A", "region": "Central Africa", "kit": "MyHeritage", "genetic share": 0.076}, {"twin": "4A", "pair": 4, "id": "A", "region": "NW Europe", "kit": "Ancestry", "genetic share": 0.12}, {"twin": "4A", "pair": 4, "id": "A", "region": "NW Europe", "kit": "23andMe", "genetic share": 0.125}, {"twin": "4A", "pair": 4, "id": "A", "region": "NW Europe", "kit": "MyHeritage", "genetic share": 0.092}, {"twin": "4B", "pair": 4, "id": "B", "region": "West Africa", "kit": "Ancestry", "genetic share": 0.6}, {"twin": "4B", "pair": 4, "id": "B", "region": "West Africa", "kit": "23andMe", "genetic share": 0.768}, {"twin": "4B", "pair": 4, "id": "B", "region": "West Africa", "kit": "MyHeritage", "genetic share": 0.707}, {"twin": "4B", "pair": 4, "id": "B", "region": "Central Africa", "kit": "Ancestry", "genetic share": 0.27}, {"twin": "4B", "pair": 4, "id": "B", "region": "Central Africa", "kit": "23andMe", "genetic share": 0.08}, {"twin": "4B", "pair": 4, "id": "B", "region": "Central Africa", "kit": "MyHeritage", "genetic share": 0.068}, {"twin": "4B", "pair": 4, "id": "B", "region": "NW Europe", "kit": "Ancestry", "genetic share": 0.12}, {"twin": "4B", "pair": 4, "id": "B", "region": "NW Europe", "kit": "23andMe", "genetic share": 0.115}, {"twin": "4B", "pair": 4, "id": "B", "region": "NW Europe", "kit": "MyHeritage", "genetic share": 0.088}, {"twin": "4B", "pair": 4, "id": "B", "region": "East Asia", "kit": "Ancestry", "genetic share": 0.01}, {"twin": "4B", "pair": 4, "id": "B", "region": "East Asia", "kit": "23andMe", "genetic share": 0.017}, {"twin": "4B", "pair": 4, "id": "B", "region": "East Asia", "kit": "MyHeritage", "genetic share": 0.0}, {"twin": "4B", "pair": 4, "id": "B", "region": "SE Europe", "kit": "Ancestry", "genetic share": 0.0}, {"twin": "4B", "pair": 4, "id": "B", "region": "SE Europe", "kit": "23andMe", "genetic share": 0.009}, {"twin": "4B", "pair": 4, "id": "B", "region": "SE Europe", "kit": "MyHeritage", "genetic share": 0.094}, {"twin": "5A", "pair": 5, "id": "A", "region": "East Asia", "kit": "Ancestry", "genetic share": 1.0}, {"twin": "5A", "pair": 5, "id": "A", "region": "East Asia", "kit": "23andMe", "genetic share": 1.0}, {"twin": "5A", "pair": 5, "id": "A", "region": "East Asia", "kit": "MyHeritage", "genetic share": 0.978}, {"twin": "5B", "pair": 5, "id": "B", "region": "East Asia", "kit": "Ancestry", "genetic share": 1.0}, {"twin": "5B", "pair": 5, "id": "B", "region": "East Asia", "kit": "23andMe", "genetic share": 1.0}, {"twin": "5B", "pair": 5, "id": "B", "region": "East Asia", "kit": "MyHeritage", "genetic share": 0.973}, {"twin": "6A", "pair": 6, "id": "A", "region": "West Africa", "kit": "Ancestry", "genetic share": 0.62}, {"twin": "6A", "pair": 6, "id": "A", "region": "West Africa", "kit": "23andMe", "genetic share": 0.636}, {"twin": "6A", "pair": 6, "id": "A", "region": "West Africa", "kit": "MyHeritage", "genetic share": 0.61}, {"twin": "6A", "pair": 6, "id": "A", "region": "NW Europe", "kit": "Ancestry", "genetic share": 0.23}, {"twin": "6A", "pair": 6, "id": "A", "region": "NW Europe", "kit": "23andMe", "genetic share": 0.245}, {"twin": "6A", "pair": 6, "id": "A", "region": "NW Europe", "kit": "MyHeritage", "genetic share": 0.251}, {"twin": "6A", "pair": 6, "id": "A", "region": "Central Africa", "kit": "Ancestry", "genetic share": 0.12}, {"twin": "6A", "pair": 6, "id": "A", "region": "Central Africa", "kit": "23andMe", "genetic share": 0.1}, {"twin": "6A", "pair": 6, "id": "A", "region": "Central Africa", "kit": "MyHeritage", "genetic share": 0.11}, {"twin": "6A", "pair": 6, "id": "A", "region": "East Asia", "kit": "Ancestry", "genetic share": 0.01}, {"twin": "6A", "pair": 6, "id": "A", "region": "East Asia", "kit": "23andMe", "genetic share": 0.006}, {"twin": "6A", "pair": 6, "id": "A", "region": "East Asia", "kit": "MyHeritage", "genetic share": 0.0}, {"twin": "6B", "pair": 6, "id": "B", "region": "West Africa", "kit": "Ancestry", "genetic share": 0.62}, {"twin": "6B", "pair": 6, "id": "B", "region": "West Africa", "kit": "23andMe", "genetic share": 0.634}, {"twin": "6B", "pair": 6, "id": "B", "region": "West Africa", "kit": "MyHeritage", "genetic share": 0.624}, {"twin": "6B", "pair": 6, "id": "B", "region": "NW Europe", "kit": "Ancestry", "genetic share": 0.23}, {"twin": "6B", "pair": 6, "id": "B", "region": "NW Europe", "kit": "23andMe", "genetic share": 0.247}, {"twin": "6B", "pair": 6, "id": "B", "region": "NW Europe", "kit": "MyHeritage", "genetic share": 0.25}, {"twin": "6B", "pair": 6, "id": "B", "region": "Central Africa", "kit": "Ancestry", "genetic share": 0.13}, {"twin": "6B", "pair": 6, "id": "B", "region": "Central Africa", "kit": "23andMe", "genetic share": 0.1}, {"twin": "6B", "pair": 6, "id": "B", "region": "Central Africa", "kit": "MyHeritage", "genetic share": 0.089}, {"twin": "6B", "pair": 6, "id": "B", "region": "East Asia", "kit": "Ancestry", "genetic share": 0.01}, {"twin": "6B", "pair": 6, "id": "B", "region": "East Asia", "kit": "23andMe", "genetic share": 0.006}, {"twin": "6B", "pair": 6, "id": "B", "region": "East Asia", "kit": "MyHeritage", "genetic share": 0.0}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
<p>This graphic shows the genetic differences among pairs of twins across different DNA kits. Each facet contains a comparison between an individual pair of twins. Each faceted row represents the results of each of the three DNA kits on that same pair of twins. Interestingly, the graphic shows that across different DNA kits, there are genetic differences between twins. Each different-colored area on the bars represents the proportion of that person’s DNA that the kit identified as being from a particular region. Controlling for differences between twins and pairs, we see that the different kits give different proportions of genetic share for regions across individuals.</p>
<p>Comparing kits:</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>compare_kits <span class="op">=</span> alt.Chart(twins_long).mark_bar().encode(</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  x<span class="op">=</span><span class="st">"kit:N"</span>,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  y<span class="op">=</span><span class="st">"genetic share:Q"</span>,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  color<span class="op">=</span><span class="st">"region:N"</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>).facet(column<span class="op">=</span><span class="st">"twin:N"</span>).properties(title<span class="op">=</span><span class="st">"Differences in DNA Shares from Various Regions in Twelve Individuals Using Three Different DNA Kits"</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>compare_kits</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">

<style>
  #altair-viz-d270337cb1d04c9c9394fdc4b4ff7440.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-d270337cb1d04c9c9394fdc4b4ff7440.vega-embed details,
  #altair-viz-d270337cb1d04c9c9394fdc4b4ff7440.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-d270337cb1d04c9c9394fdc4b4ff7440"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-d270337cb1d04c9c9394fdc4b4ff7440") {
      outputDiv = document.getElementById("altair-viz-d270337cb1d04c9c9394fdc4b4ff7440");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.8.0?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.8.0"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "data": {"name": "data-d9664b3f38f6546e2a5b7833f81deddf"}, "facet": {"column": {"field": "twin", "type": "nominal"}}, "spec": {"mark": {"type": "bar"}, "encoding": {"color": {"field": "region", "type": "nominal"}, "x": {"field": "kit", "type": "nominal"}, "y": {"field": "genetic share", "type": "quantitative"}}}, "title": "Differences in DNA Shares from Various Regions in Twelve Individuals Using Three Different DNA Kits", "$schema": "https://vega.github.io/schema/vega-lite/v5.8.0.json", "datasets": {"data-d9664b3f38f6546e2a5b7833f81deddf": [{"twin": "1A", "pair": 1, "id": "A", "region": "NW Europe", "kit": "Ancestry", "genetic share": 0.9}, {"twin": "1A", "pair": 1, "id": "A", "region": "NW Europe", "kit": "23andMe", "genetic share": 0.676}, {"twin": "1A", "pair": 1, "id": "A", "region": "NW Europe", "kit": "MyHeritage", "genetic share": 0.647}, {"twin": "1A", "pair": 1, "id": "A", "region": "SE Europe", "kit": "Ancestry", "genetic share": 0.1}, {"twin": "1A", "pair": 1, "id": "A", "region": "SE Europe", "kit": "23andMe", "genetic share": 0.32}, {"twin": "1A", "pair": 1, "id": "A", "region": "SE Europe", "kit": "MyHeritage", "genetic share": 0.333}, {"twin": "1B", "pair": 1, "id": "B", "region": "NW Europe", "kit": "Ancestry", "genetic share": 0.9}, {"twin": "1B", "pair": 1, "id": "B", "region": "NW Europe", "kit": "23andMe", "genetic share": 0.691}, {"twin": "1B", "pair": 1, "id": "B", "region": "NW Europe", "kit": "MyHeritage", "genetic share": 0.687}, {"twin": "1B", "pair": 1, "id": "B", "region": "SE Europe", "kit": "Ancestry", "genetic share": 0.1}, {"twin": "1B", "pair": 1, "id": "B", "region": "SE Europe", "kit": "23andMe", "genetic share": 0.305}, {"twin": "1B", "pair": 1, "id": "B", "region": "SE Europe", "kit": "MyHeritage", "genetic share": 0.239}, {"twin": "2A", "pair": 2, "id": "A", "region": "West Africa", "kit": "Ancestry", "genetic share": 0.65}, {"twin": "2A", "pair": 2, "id": "A", "region": "West Africa", "kit": "23andMe", "genetic share": 0.762}, {"twin": "2A", "pair": 2, "id": "A", "region": "West Africa", "kit": "MyHeritage", "genetic share": 0.696}, {"twin": "2A", "pair": 2, "id": "A", "region": "Central Africa", "kit": "Ancestry", "genetic share": 0.22}, {"twin": "2A", "pair": 2, "id": "A", "region": "Central Africa", "kit": "23andMe", "genetic share": 0.076}, {"twin": "2A", "pair": 2, "id": "A", "region": "Central Africa", "kit": "MyHeritage", "genetic share": 0.12}, {"twin": "2A", "pair": 2, "id": "A", "region": "NW Europe", "kit": "Ancestry", "genetic share": 0.12}, {"twin": "2A", "pair": 2, "id": "A", "region": "NW Europe", "kit": "23andMe", "genetic share": 0.139}, {"twin": "2A", "pair": 2, "id": "A", "region": "NW Europe", "kit": "MyHeritage", "genetic share": 0.104}, {"twin": "2A", "pair": 2, "id": "A", "region": "SE Europe", "kit": "Ancestry", "genetic share": 0.01}, {"twin": "2A", "pair": 2, "id": "A", "region": "SE Europe", "kit": "23andMe", "genetic share": 0.006}, {"twin": "2A", "pair": 2, "id": "A", "region": "SE Europe", "kit": "MyHeritage", "genetic share": 0.0}, {"twin": "2B", "pair": 2, "id": "B", "region": "West Africa", "kit": "Ancestry", "genetic share": 0.64}, {"twin": "2B", "pair": 2, "id": "B", "region": "West Africa", "kit": "23andMe", "genetic share": 0.76}, {"twin": "2B", "pair": 2, "id": "B", "region": "West Africa", "kit": "MyHeritage", "genetic share": 0.688}, {"twin": "2B", "pair": 2, "id": "B", "region": "Central Africa", "kit": "Ancestry", "genetic share": 0.23}, {"twin": "2B", "pair": 2, "id": "B", "region": "Central Africa", "kit": "23andMe", "genetic share": 0.078}, {"twin": "2B", "pair": 2, "id": "B", "region": "Central Africa", "kit": "MyHeritage", "genetic share": 0.112}, {"twin": "2B", "pair": 2, "id": "B", "region": "NW Europe", "kit": "Ancestry", "genetic share": 0.12}, {"twin": "2B", "pair": 2, "id": "B", "region": "NW Europe", "kit": "23andMe", "genetic share": 0.131}, {"twin": "2B", "pair": 2, "id": "B", "region": "NW Europe", "kit": "MyHeritage", "genetic share": 0.106}, {"twin": "2B", "pair": 2, "id": "B", "region": "SE Europe", "kit": "Ancestry", "genetic share": 0.01}, {"twin": "2B", "pair": 2, "id": "B", "region": "SE Europe", "kit": "23andMe", "genetic share": 0.006}, {"twin": "2B", "pair": 2, "id": "B", "region": "SE Europe", "kit": "MyHeritage", "genetic share": 0.0}, {"twin": "3A", "pair": 3, "id": "A", "region": "NW Europe", "kit": "Ancestry", "genetic share": 0.99}, {"twin": "3A", "pair": 3, "id": "A", "region": "NW Europe", "kit": "23andMe", "genetic share": 0.987}, {"twin": "3A", "pair": 3, "id": "A", "region": "NW Europe", "kit": "MyHeritage", "genetic share": 0.992}, {"twin": "3A", "pair": 3, "id": "A", "region": "West Africa", "kit": "Ancestry", "genetic share": 0.01}, {"twin": "3A", "pair": 3, "id": "A", "region": "West Africa", "kit": "23andMe", "genetic share": 0.07}, {"twin": "3A", "pair": 3, "id": "A", "region": "West Africa", "kit": "MyHeritage", "genetic share": 0.0}, {"twin": "3B", "pair": 3, "id": "B", "region": "NW Europe", "kit": "Ancestry", "genetic share": 0.99}, {"twin": "3B", "pair": 3, "id": "B", "region": "NW Europe", "kit": "23andMe", "genetic share": 0.987}, {"twin": "3B", "pair": 3, "id": "B", "region": "NW Europe", "kit": "MyHeritage", "genetic share": 0.981}, {"twin": "3B", "pair": 3, "id": "B", "region": "West Africa", "kit": "Ancestry", "genetic share": 0.01}, {"twin": "3B", "pair": 3, "id": "B", "region": "West Africa", "kit": "23andMe", "genetic share": 0.01}, {"twin": "3B", "pair": 3, "id": "B", "region": "West Africa", "kit": "MyHeritage", "genetic share": 0.0}, {"twin": "4A", "pair": 4, "id": "A", "region": "West Africa", "kit": "Ancestry", "genetic share": 0.6}, {"twin": "4A", "pair": 4, "id": "A", "region": "West Africa", "kit": "23andMe", "genetic share": 0.772}, {"twin": "4A", "pair": 4, "id": "A", "region": "West Africa", "kit": "MyHeritage", "genetic share": 0.692}, {"twin": "4A", "pair": 4, "id": "A", "region": "Central Africa", "kit": "Ancestry", "genetic share": 0.27}, {"twin": "4A", "pair": 4, "id": "A", "region": "Central Africa", "kit": "23andMe", "genetic share": 0.076}, {"twin": "4A", "pair": 4, "id": "A", "region": "Central Africa", "kit": "MyHeritage", "genetic share": 0.076}, {"twin": "4A", "pair": 4, "id": "A", "region": "NW Europe", "kit": "Ancestry", "genetic share": 0.12}, {"twin": "4A", "pair": 4, "id": "A", "region": "NW Europe", "kit": "23andMe", "genetic share": 0.125}, {"twin": "4A", "pair": 4, "id": "A", "region": "NW Europe", "kit": "MyHeritage", "genetic share": 0.092}, {"twin": "4B", "pair": 4, "id": "B", "region": "West Africa", "kit": "Ancestry", "genetic share": 0.6}, {"twin": "4B", "pair": 4, "id": "B", "region": "West Africa", "kit": "23andMe", "genetic share": 0.768}, {"twin": "4B", "pair": 4, "id": "B", "region": "West Africa", "kit": "MyHeritage", "genetic share": 0.707}, {"twin": "4B", "pair": 4, "id": "B", "region": "Central Africa", "kit": "Ancestry", "genetic share": 0.27}, {"twin": "4B", "pair": 4, "id": "B", "region": "Central Africa", "kit": "23andMe", "genetic share": 0.08}, {"twin": "4B", "pair": 4, "id": "B", "region": "Central Africa", "kit": "MyHeritage", "genetic share": 0.068}, {"twin": "4B", "pair": 4, "id": "B", "region": "NW Europe", "kit": "Ancestry", "genetic share": 0.12}, {"twin": "4B", "pair": 4, "id": "B", "region": "NW Europe", "kit": "23andMe", "genetic share": 0.115}, {"twin": "4B", "pair": 4, "id": "B", "region": "NW Europe", "kit": "MyHeritage", "genetic share": 0.088}, {"twin": "4B", "pair": 4, "id": "B", "region": "East Asia", "kit": "Ancestry", "genetic share": 0.01}, {"twin": "4B", "pair": 4, "id": "B", "region": "East Asia", "kit": "23andMe", "genetic share": 0.017}, {"twin": "4B", "pair": 4, "id": "B", "region": "East Asia", "kit": "MyHeritage", "genetic share": 0.0}, {"twin": "4B", "pair": 4, "id": "B", "region": "SE Europe", "kit": "Ancestry", "genetic share": 0.0}, {"twin": "4B", "pair": 4, "id": "B", "region": "SE Europe", "kit": "23andMe", "genetic share": 0.009}, {"twin": "4B", "pair": 4, "id": "B", "region": "SE Europe", "kit": "MyHeritage", "genetic share": 0.094}, {"twin": "5A", "pair": 5, "id": "A", "region": "East Asia", "kit": "Ancestry", "genetic share": 1.0}, {"twin": "5A", "pair": 5, "id": "A", "region": "East Asia", "kit": "23andMe", "genetic share": 1.0}, {"twin": "5A", "pair": 5, "id": "A", "region": "East Asia", "kit": "MyHeritage", "genetic share": 0.978}, {"twin": "5B", "pair": 5, "id": "B", "region": "East Asia", "kit": "Ancestry", "genetic share": 1.0}, {"twin": "5B", "pair": 5, "id": "B", "region": "East Asia", "kit": "23andMe", "genetic share": 1.0}, {"twin": "5B", "pair": 5, "id": "B", "region": "East Asia", "kit": "MyHeritage", "genetic share": 0.973}, {"twin": "6A", "pair": 6, "id": "A", "region": "West Africa", "kit": "Ancestry", "genetic share": 0.62}, {"twin": "6A", "pair": 6, "id": "A", "region": "West Africa", "kit": "23andMe", "genetic share": 0.636}, {"twin": "6A", "pair": 6, "id": "A", "region": "West Africa", "kit": "MyHeritage", "genetic share": 0.61}, {"twin": "6A", "pair": 6, "id": "A", "region": "NW Europe", "kit": "Ancestry", "genetic share": 0.23}, {"twin": "6A", "pair": 6, "id": "A", "region": "NW Europe", "kit": "23andMe", "genetic share": 0.245}, {"twin": "6A", "pair": 6, "id": "A", "region": "NW Europe", "kit": "MyHeritage", "genetic share": 0.251}, {"twin": "6A", "pair": 6, "id": "A", "region": "Central Africa", "kit": "Ancestry", "genetic share": 0.12}, {"twin": "6A", "pair": 6, "id": "A", "region": "Central Africa", "kit": "23andMe", "genetic share": 0.1}, {"twin": "6A", "pair": 6, "id": "A", "region": "Central Africa", "kit": "MyHeritage", "genetic share": 0.11}, {"twin": "6A", "pair": 6, "id": "A", "region": "East Asia", "kit": "Ancestry", "genetic share": 0.01}, {"twin": "6A", "pair": 6, "id": "A", "region": "East Asia", "kit": "23andMe", "genetic share": 0.006}, {"twin": "6A", "pair": 6, "id": "A", "region": "East Asia", "kit": "MyHeritage", "genetic share": 0.0}, {"twin": "6B", "pair": 6, "id": "B", "region": "West Africa", "kit": "Ancestry", "genetic share": 0.62}, {"twin": "6B", "pair": 6, "id": "B", "region": "West Africa", "kit": "23andMe", "genetic share": 0.634}, {"twin": "6B", "pair": 6, "id": "B", "region": "West Africa", "kit": "MyHeritage", "genetic share": 0.624}, {"twin": "6B", "pair": 6, "id": "B", "region": "NW Europe", "kit": "Ancestry", "genetic share": 0.23}, {"twin": "6B", "pair": 6, "id": "B", "region": "NW Europe", "kit": "23andMe", "genetic share": 0.247}, {"twin": "6B", "pair": 6, "id": "B", "region": "NW Europe", "kit": "MyHeritage", "genetic share": 0.25}, {"twin": "6B", "pair": 6, "id": "B", "region": "Central Africa", "kit": "Ancestry", "genetic share": 0.13}, {"twin": "6B", "pair": 6, "id": "B", "region": "Central Africa", "kit": "23andMe", "genetic share": 0.1}, {"twin": "6B", "pair": 6, "id": "B", "region": "Central Africa", "kit": "MyHeritage", "genetic share": 0.089}, {"twin": "6B", "pair": 6, "id": "B", "region": "East Asia", "kit": "Ancestry", "genetic share": 0.01}, {"twin": "6B", "pair": 6, "id": "B", "region": "East Asia", "kit": "23andMe", "genetic share": 0.006}, {"twin": "6B", "pair": 6, "id": "B", "region": "East Asia", "kit": "MyHeritage", "genetic share": 0.0}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
<p>This chart shows the differences between kits by creating one facet for each individual and displaying the results of different DNA kits side by side. Different kits show different genetic shares for regions across the same person. The differences between kits may explain some, though not all, of the genetic differences between twins displayed in the previous graphic. The way this chart is set up admittedly makes it difficult to make side-by-side comparisons of all of the genetic shares, but the main story that there are differences in the proportions is evident without requiring direct comparisons between all related values.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>